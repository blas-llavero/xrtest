import{c as I,e as j,P as b,a as w,V as E,b as N,d as W,f as P,A as V,g as l,W as U,S as X,I as Y,D as H,h as K,i,L as z,E as J,j as h,k as Q,M as Z,O as _,l as $,m as ee,n as te,o as G,p as C,q as g,r as d,B as oe,s as u,t as re}from"./vendor-BhQtOaHi.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(e){if(e.ep)return;e.ep=!0;const o=n(e);fetch(e.href,o)}})();class ne extends I({welcomePanel:{required:[b,w],where:[j(b,"config","/ui/welcome.json")]}}){init(){this.queries.welcomePanel.subscribe("qualify",r=>{const n=w.data.document[r.index];if(!n)return;const s=n.getElementById("xr-button");s.addEventListener("click",()=>{this.world.visibilityState.value===E.NonImmersive?this.world.launchXR():this.world.exitXR()}),this.world.visibilityState.subscribe(e=>{e===E.NonImmersive?s.setProperties({text:"Enter XR"}):s.setProperties({text:"Exit to Browser"})})})}}const T=N("Robot",{});class se extends I({robot:{required:[T]},robotClicked:{required:[T,W]}}){init(){this.lookAtTarget=new P,this.vec3=new P,this.queries.robotClicked.subscribe("qualify",r=>{V.play(r)})}update(){this.queries.robot.entities.forEach(r=>{this.player.head.getWorldPosition(this.lookAtTarget);const n=r.object3D;n.getWorldPosition(this.vec3),this.lookAtTarget.y=this.vec3.y,n.lookAt(this.lookAtTarget)})}}const ae={chimeSound:{url:"/audio/chime.mp3",type:l.Audio,priority:"background"},webxr:{url:"/textures/webxr.png",type:l.Texture,priority:"critical"},environmentDesk:{url:"/gltf/environmentDesk/environmentDesk.gltf",type:l.GLTF,priority:"critical"},plantSansevieria:{url:"/gltf/plantSansevieria/plantSansevieria.gltf",type:l.GLTF,priority:"critical"},robot:{url:"/gltf/robot/robot.gltf",type:l.GLTF,priority:"critical"}};U.create(document.getElementById("scene-container"),{assets:ae,xr:{sessionMode:X.ImmersiveVR,offer:"always",features:{handTracking:!0,layers:!0}},features:{locomotion:!0,grabbing:!0,physics:!1,sceneUnderstanding:!1},render:{defaultLighting:!1}}).then(t=>{t.activeLevel.value.addComponent(Y,{sky:[.12,.18,.35,1],equator:[.25,.32,.45,1],ground:[.1,.1,.12,1],intensity:.8});const n=new H(16777215,1);n.position.set(5,5,5),t.scene.add(n);const s=new K(4210752,.4);t.scene.add(s),i.loadGLTF("/gltf/dynamic-object.glb","dynamicModel").then(()=>{const m=i.getGLTF("dynamicModel");if(!m){console.error("No s'ha trobat el GLTF 'dynamicModel' desprÃ©s de carregar-lo");return}const L=m.scene;L.position.set(0,2,-3),t.createTransformEntity(L)}).catch(m=>{console.error("Failed to load dynamic asset:",m)});const{camera:e}=t;e.position.set(-4,1.5,-6),e.rotateY(-Math.PI*.75);const{scene:o}=i.getGLTF("environmentDesk");o.rotateY(Math.PI),o.position.set(0,-.1,0),t.createTransformEntity(o).addComponent(z,{type:J.STATIC});const{scene:c}=i.getGLTF("plantSansevieria");c.position.set(1.2,.85,-1.8),t.createTransformEntity(c).addComponent(h).addComponent(Q,{translate:!0,rotate:!0,scale:!0,movementMode:Z.MoveFromTarget});const{scene:a}=i.getGLTF("robot");a.position.set(-1.2,.4,-1.8),a.scale.setScalar(1),a.position.set(-1.2,.95,-1.8),a.scale.setScalar(.5),a.position.set(0,1,-3),a.scale.setScalar(.5),t.createTransformEntity(a),t.createTransformEntity(a).addComponent(h).addComponent(_,{translate:!0,rotate:!0}).addComponent(T).addComponent($,{src:"/audio/chime.mp3",maxInstances:3,playbackMode:ee.FadeRestart}),t.createTransformEntity().addComponent(b,{config:"/ui/welcome.json",maxHeight:.8,maxWidth:1.6}).addComponent(h).addComponent(te,{top:"20px",left:"20px",height:"40%"}).object3D.position.set(0,1.29,-1.9);const p=i.getTexture("webxr");if(!p){console.error("No s'ha pogut trobar la textura 'webxr'");return}p.colorSpace=G;const A=new C({map:p,transparent:!0}),k=new g(1.13,.32),v=new d(k,A);v.position.set(0,1.8,-1.9),t.createTransformEntity(v);const x=i.getTexture("webxr");x.colorSpace=G;const y=new d(new g(3.39,.96),new C({map:x,transparent:!0}));t.createTransformEntity(y),y.position.set(0,1,1.8),y.rotateY(Math.PI);const F=new oe(1,1,1),q=new u({color:16724787}),M=new d(F,q);M.position.set(-1,0,-2),t.createTransformEntity(M);const R=new re(.5,64,64),B=new u({color:16777215,metalness:1,roughness:.05});new u({color:212787});const S=new d(R,B);S.position.set(0,1.2,-2),t.createTransformEntity(S);const D=new g(4,4),O=new u({color:3355647}),f=new d(D,O);f.position.set(0,-1,-2),f.rotation.x=-Math.PI/2,t.createTransformEntity(f),t.registerSystem(ne).registerSystem(se)});
